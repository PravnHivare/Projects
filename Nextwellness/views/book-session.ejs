<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Session</title> 
    <link rel="stylesheet" href="style.css"> 
    <link rel="stylesheet" href="product.css">  
    <style>
        .image {
            height: 50px;
            width: 50px;
            position: relative;
            bottom: -10px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        th {
            background-color: #f2f2f2;
        }

        .edit-input {
            display: none;
        }

        /* Specific styles for book-session.ejs */
        /* Adjust as needed to match the styling of userDetails.ejs */
        form {
            margin: 20px auto;
            width: 80%;
            max-width: 600px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        label {
            font-weight: bold;
        }

        input[type="email"],
        input[type="date"],
        input[type="time"] {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: #fff;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .mb-3 {
            margin-bottom: 1rem;
        }

        .mt-3 {
            margin-top: 1rem;
        }

        .row {
            display: flex;
            flex-wrap: wrap;
            margin-left: -5px;
            margin-right: -5px;
        }

        .col {
            flex: 1;
            padding: 0 5px;
        }
         #appointmentTime {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    box-sizing: border-box;
}  
.button-link {
            display: inline-block;
            padding: 10px 20px; /* Padding for space inside the button */
            background-color: #007BFF; /* Background color */
            color: #FFFFFF; /* Text color */
            text-decoration: none; /* Remove underline */
            border-radius: 5px; /* Rounded corners */
            border: none; /* No border */
            cursor: pointer; /* Pointer cursor on hover */
            font-weight: bold; /* Bold text */
            transition: background-color 0.3s; /* Transition for hover effect */
        }

        /* Add hover effect */
        .button-link:hover {
            background-color: #0056b3; /* Darker background on hover */
        } 
           
       </style>
        <link rel="apple-touch-icon" sizes="180x180" href="assets/img/gallery/nextwellness.png">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/img/gallery/nextwellness.png">
        <link rel="icon" type="image/png" sizes="16x16" hhref="assets/img/gallery/nextwellness.png">
        <link rel="manifest" href="site.webmanifest">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="apple-touch-icon" sizes="180x180" href="assets/img/favicons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/img/gallery/nextwellness.png">
        <link rel="icon" type="image/png" sizes="16x16" href="assets/img/gallery/nextwellness.png">
        <link rel="shortcut icon" type="image/x-icon" href="assets/img/gallery/nextwellness.png">
        <link rel="manifest" href="assets/img/favicons/manifest.json">
</head>
<body> 
    <div class="container">
        <div class="navigation">
            <ul>
                <li>
                    <a href="#">
                        <span class="icon">
                         <img class="image" src="Logo.png" alt="">
                        </span>
                        <span class="title">NextWellness</span>
                    </a>
                </li>
                <li>
                    <a href="/dashboard">
                        <span class="icon">
                            <ion-icon name="home-outline"></ion-icon>
                        </span>
                        <span class="title">Dashbord</span>
                    </a>
                </li>
                <li>
                    <a href="/add-product">
                        <span class="icon">
                            <ion-icon name="create-outline"></ion-icon>
                        </span>
                        <span class="title">Add Products<span>
                    </a>
                </li>
                <li>
                    <a href="/add-treatment">
                        <span class="icon">
                            <ion-icon name="document-outline"></ion-icon>
                        </span>
                        <span class="title">Add Treatments</span>
                    </a>
                </li>
                <li>
                    <a href="/record">
                        <span class="icon">
                            <ion-icon name="document-outline"></ion-icon>
                        </span>
                        <span class="title">View Appointments</span>
                    </a>
                </li>
                <li>
                    <a href="/users">
                        <span class="icon">
                            <ion-icon name="document-outline"></ion-icon>
                        </span>
                        <span class="title">Users</span>
                    </a>
                </li>
             
                <!--<li>
                    <a href="/sub">
                        <span class="icon">
                            <ion-icon name="exit-outline"></ion-icon>
                        </span>
                        <span class="title">Subscription</span>
                    </a>
                </li>-->  

                <li>
                    <a href="/book-session">
                        <span class="icon">
                            <ion-icon name="exit-outline"></ion-icon>
                        </span>
                        <span class="title">Book session</span>
                    </a>
                </li>


                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="exit-outline"></ion-icon>
                        </span>
                        <span class="title">sign out</span>
                    </a>
                </li>


            </ul>

        </div>
    </div>
    <div class="main">
        <div class="topbar">
            <div class="toggle">
                <ion-icon name="menu-outline"></ion-icon>
            </div>
            <div class="search">
                <label for="search">
                    <input type="text" id="searchInput" placeholder="Search here">
                    <ion-icon name="search-outline" onclick="search()"></ion-icon>
                </label>
            </div>
            <div class="user">
                <img src="Logo.png" alt="">
            </div>
        </div> 
        <h1 style="text-align: center;">Book Session</h1>
<form action="/book-session" method="POST">
    <div class="mb-3 mt-3 row g-9 align-items-center">  
        <div class="col col-lg-2"><label class="form-label">Email: </label></div>
        <div class="col"><input type="email" id="email" name="email" required></div>
      </div>  

      <div class="mb-3 mt-3 row g-9 align-items-center">  
        <div class="col col-lg-2"><label class="form-label">Date: </label></div>
        <div class="col"><input type="date" id="appointmentDate" name="appointmentDate" required></div>
      </div>  

      <div class="mb-3 mt-3 row g-9 align-items-center">  
        <div class="col col-lg-2"><label class="form-label">Time: </label></div>
        <div class="col"><select id="appointmentTime" name="appointmentTime" required class="formbold-form-input">
            <option value="11:00">11:00 AM - 12:00 PM</option>
            <option value="12:00">12:00 PM - 01:00 PM</option>
            <option value="13:00">01:00 PM - 02:00 PM</option>
            <option value="14:00">02:00 PM - 03:00 PM</option>
            <option value="15:00">03:00 PM - 04:00 PM</option>
            <option value="16:00">04:00 PM - 05:00 PM</option>
            <option value="17:00">05:00 PM - 06:00 PM</option>
            <option value="18:00">06:00 PM - 07:00 PM</option>
            <option value="19:00">07:00 PM - 08:00 PM</option>
            <option value="20:00">08:00 PM - 09:00 PM</option>
          </select></div>
      </div>  

      <div class="mb-5 mt-3 align-items-center text-center"> 
        <button type="submit" class="btn btn-success">Book Session</button>
   </div>
</form> 
<table id="dataTable">
    <thead>
        <tr>
            <th>Name</th>
            <th>email</th>
            <th>Contact Number</th>
            <th>Address</th>
            <th>Remaining Sessions</th>
            <th>Appointment Date</th>
            <th>Appointment Time</th>
            <th>Action</th> <!-- New column for Cancel button -->
        </tr>
    </thead>
    <tbody>
        <% users1.forEach((user, index) => { %> <!-- Added index parameter -->
            <tr>
                <td><%= user.Name %></td>
                <td><%= user.email %></td>
                <td><%= user.ContactNumber %></td>
                <td><%= user.Address %></td>
                <td><%= user.remainingSessions %></td>
                <td><%= user.consult.appointmentDate %></td>
                <td><%= user.consult.appointmentTime %></td>
                <td><button class="button-link cancel-btn" onclick="removeRow(this)">Cancel</button></td> <!-- Changed parameter to 'this' -->
            </tr>
        <% }); %>
    </tbody>
</table>  
  
        
    </div>
   
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script>
        // add hovered class to selected list item

// Menu Toggle
let toggle = document.querySelector(".toggle");
let navigation = document.querySelector(".navigation");
let main = document.querySelector(".main");

toggle.onclick = function () {
  navigation.classList.toggle("active");
  main.classList.toggle("active");
};

    </script>  
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
    // Bind checkAvailability function to change event of appointmentDate input
    $('#appointmentDate').change(checkAvailability);

    function checkAvailability() {
      const selectedDate = document.getElementById("appointmentDate").value;

      // AJAX request to fetch existing appointments for the selected date
      $.post(`/check-availability`, { appointmentDate: selectedDate }, function(response) {
        const bookedSlots = response.bookedSlots;
        const timeSlots = document.getElementById("appointmentTime").options;

        // Enable all options first
        for (let i = 0; i < timeSlots.length; i++) {
          timeSlots[i].disabled = false;
          // Reset the style to default
          timeSlots[i].style.color = "#0a0a0a";
        }

        // Disable the booked time slots
        for (const slot of bookedSlots) {
          const option = document.querySelector(`#appointmentTime option[value='${slot}']`);
          if (option) {
            option.disabled = true;
            // Optionally, you can style the disabled options to appear in grey
            option.style.color = "grey";
          }
        }
      });
    }
  });
    </script> 

<script>
    function search() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("dataTable");
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td");
            for (var j = 0; j < td.length; j++) {
                if (td[j]) {
                    txtValue = td[j].textContent || td[j].innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                        break; // Break the inner loop if match found in any cell
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    }
</script>

</body>
</html>
